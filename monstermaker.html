<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Monster Maker</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Monster Maker</h1>

  <!-- Basic Info -->
  <div class="section">
    <h2>Basic Info</h2>
    <label>Name: <input type="text" id="name"></label>
    <label>Size:
      <select id="size">
        <option value="Tiny">Tiny</option>
        <option value="Small">Small</option>
        <option value="Medium">Medium</option>
        <option value="Large">Large</option>
        <option value="Huge">Huge</option>
        <option value="Gargantuan">Gargantuan</option>
      </select>
    </label>
    <label>Type:
      <select id="type">
        <option value="aberration">Aberration</option>
        <option value="beast">Beast</option>
        <option value="celestial">Celestial</option>
        <option value="construct">Construct</option>
        <option value="dragon">Dragon</option>
        <option value="elemental">Elemental</option>
        <option value="fey">Fey</option>
        <option value="fiend">Fiend</option>
        <option value="giant">Giant</option>
        <option value="humanoid">Humanoid</option>
        <option value="monstrosity">Monstrosity</option>
        <option value="ooze">Ooze</option>
        <option value="plant">Plant</option>
        <option value="undead">Undead</option>
      </select>
    </label>
    <label>Alignment:
      <select id="alignment">
        <option value="lawful good">Lawful Good</option>
        <option value="neutral good">Neutral Good</option>
        <option value="chaotic good">Chaotic Good</option>
        <option value="lawful neutral">Lawful Neutral</option>
        <option value="true neutral">True Neutral</option>
        <option value="chaotic neutral">Chaotic Neutral</option>
        <option value="lawful evil">Lawful Evil</option>
        <option value="neutral evil">Neutral Evil</option>
        <option value="chaotic evil">Chaotic Evil</option>
      </select>
    </label>
    <label>Armor Class: <input type="text" id="ac"></label>
    <label>Hit Points: <input type="text" id="hp"></label>
    <label>Challenge Rating (CR): <input type="text" id="cr"></label>
    <label>Source: <input type="text" id="source"></label>
  </div>

  <!-- Speeds -->
  <div class="section">
    <h2>Speeds</h2>
    <div id="speed-list"></div>
    <button type="button" onclick="addSpeed()">+ Add Speed</button>
  </div>

  <!-- Ability Scores -->
  <div class="section">
    <h2>Ability Scores</h2>
    <div style="display:flex; gap:10px;">
      <label>STR: <input type="number" id="str"></label>
      <label>DEX: <input type="number" id="dex"></label>
      <label>CON: <input type="number" id="con"></label>
      <label>INT: <input type="number" id="int"></label>
      <label>WIS: <input type="number" id="wis"></label>
      <label>CHA: <input type="number" id="cha"></label>
    </div>
  </div>

  <!-- Extra Fields -->
  <div class="section">
    <h2>Other Stats</h2>
    <label>Saving Throws: <input type="text" id="saves"></label>
    <label>Skills: <input type="text" id="skills"></label>
    <label>Damage Immunities: <input type="text" id="immunities"></label>
    <label>Damage Resistances: <input type="text" id="resistance"></label>
    <label>Damage Vulnerabilities: <input type="text" id="vulnerability"></label>
    <label>Condition Immunities: <input type="text" id="conimmunities"></label>
    <label>Senses: <input type="text" id="senses"></label>
    <label>Languages: <input type="text" id="languages"></label>
    <label>Legendary Actions per Round: <input type="text" id="legendarynumber"></label>
    <label>Description: <textarea id="description"></textarea></label>
  </div>

  <!-- Traits -->
  <div class="section">
    <h2>Traits</h2>
    <div id="traits"></div>
    <button type="button" onclick="addTrait()">+ Add Trait</button>
  </div>

  <!-- Actions -->
  <div class="section">
    <h2>Actions</h2>
    <div id="actions"></div>
    <button type="button" onclick="addAction()">+ Add Action</button>
  </div>

  <!-- Reactions -->
  <div class="section">
    <h2>Reactions</h2>
    <div id="reactions"></div>
    <button type="button" onclick="addReaction()">+ Add Reaction</button>
  </div>

  <!-- Legendary Actions -->
  <div class="section">
    <h2>Legendary Actions</h2>
    <div id="legendaryActions"></div>
    <button type="button" onclick="addLegendaryAction()">+ Add Legendary Action</button>
  </div>

  <!-- Lair Actions -->
  <div class="section">
    <h2>Lair Actions</h2>
    <label>Lair Description: <textarea id="lairDescription"></textarea></label>
    <div id="lairBullets"></div>
    <button type="button" onclick="addLairBullet()">+ Add Lair Bullet</button>
  </div>

  <!-- Regional Effects -->
  <div class="section">
    <h2>Regional Effects</h2>
    <label>Regional Description: <textarea id="regionalDescription"></textarea></label>
    <div id="regionalBullets"></div>
    <button type="button" onclick="addRegionalBullet()">+ Add Regional Bullet</button>
    <label>Secondary Description: <textarea id="regionalSecondary"></textarea></label>
  </div>

  <button onclick="saveMonster()">Save Monster JSON</button>

  <script>
    function addSpeed(type = "", value = "") {
      const div = document.createElement("div");
      div.innerHTML = `
        <input type="text" placeholder="Type (e.g. fly)" value="${type}">
        <input type="text" placeholder="Speed (e.g. 30 ft.)" value="${value}">
        <button type="button" onclick="this.parentElement.remove()">Remove</button>
      `;
      document.getElementById("speed-list").appendChild(div);
    }

    function addTrait(name = "", desc = "") {
      const div = document.createElement("div");
      div.innerHTML = `<input type="text" placeholder="Trait Name" value="${name}">
        <textarea placeholder="Trait Description">${desc}</textarea>
        <button type="button" onclick="this.parentElement.remove()">Remove</button>`;
      document.getElementById("traits").appendChild(div);
    }

    function addAction(name = "", desc = "") {
      const div = document.createElement("div");
      div.innerHTML = `<input type="text" placeholder="Action Name" value="${name}">
        <textarea placeholder="Action Description">${desc}</textarea>
        <button type="button" onclick="this.parentElement.remove()">Remove</button>`;
      document.getElementById("actions").appendChild(div);
    }

    function addReaction(name = "", desc = "") {
      const div = document.createElement("div");
      div.innerHTML = `<input type="text" placeholder="Reaction Name" value="${name}">
        <textarea placeholder="Reaction Description">${desc}</textarea>
        <button type="button" onclick="this.parentElement.remove()">Remove</button>`;
      document.getElementById("reactions").appendChild(div);
    }

    function addLegendaryAction(name = "", desc = "") {
      const div = document.createElement("div");
      div.innerHTML = `<input type="text" placeholder="Legendary Action Name" value="${name}">
        <textarea placeholder="Legendary Action Description">${desc}</textarea>
        <button type="button" onclick="this.parentElement.remove()">Remove</button>`;
      document.getElementById("legendaryActions").appendChild(div);
    }

    function addLairBullet(text = "") {
      const div = document.createElement("div");
      div.innerHTML = `<input type="text" placeholder="Lair Effect Bullet" value="${text}">
        <button type="button" onclick="this.parentElement.remove()">Remove</button>`;
      document.getElementById("lairBullets").appendChild(div);
    }

    function addRegionalBullet(text = "") {
      const div = document.createElement("div");
      div.innerHTML = `<input type="text" placeholder="Regional Effect Bullet" value="${text}">
        <button type="button" onclick="this.parentElement.remove()">Remove</button>`;
      document.getElementById("regionalBullets").appendChild(div);
    }

    function saveMonster() {
      const name = document.getElementById("name").value || "Custom Monster";
      const size = document.getElementById("size").value;
      const type = document.getElementById("type").value;
      const cr = document.getElementById("cr").value;
      const source = document.getElementById("source").value;

      const monster = {
        name: name,
        tags: [size.toLowerCase(), type.toLowerCase(), "cr" + cr, source || "homebrew"],
        size: size,
        type: type,
        alignment: document.getElementById("alignment").value,
        cr: cr,
        hp: document.getElementById("hp").value,
        ac: document.getElementById("ac").value,
        speed: Array.from(document.querySelectorAll("#speed-list div")).map(div => {
          const [t, v] = div.querySelectorAll("input");
          return `${t.value} ${v.value}`;
        }).join(", "),
        abilities: {
          str: parseInt(document.getElementById("str").value) || 0,
          dex: parseInt(document.getElementById("dex").value) || 0,
          con: parseInt(document.getElementById("con").value) || 0,
          int: parseInt(document.getElementById("int").value) || 0,
          wis: parseInt(document.getElementById("wis").value) || 0,
          cha: parseInt(document.getElementById("cha").value) || 0
        },
        saves: document.getElementById("saves").value,
        skills: document.getElementById("skills").value,
        immunities: document.getElementById("immunities").value,
        resistance: document.getElementById("resistance").value,
        vulnerability: document.getElementById("vulnerability").value,
        conimmunities: document.getElementById("conimmunities").value,
        senses: document.getElementById("senses").value,
        languages: document.getElementById("languages").value,
        legendarynumber: document.getElementById("legendarynumber").value,
        traits: Array.from(document.querySelectorAll("#traits div")).map(div => ({
          name: div.querySelector("input").value,
          desc: div.querySelector("textarea").value
        })),
        actions: Array.from(document.querySelectorAll("#actions div")).map(div => ({
          name: div.querySelector("input").value,
          desc: div.querySelector("textarea").value
        })),
        reactions: Array.from(document.querySelectorAll("#reactions div")).map(div => ({
          name: div.querySelector("input").value,
          desc: div.querySelector("textarea").value
        })),
        legendary: Array.from(document.querySelectorAll("#legendaryActions div")).map(div => ({
          name: div.querySelector("input").value,
          desc: div.querySelector("textarea").value
        })),
        description: document.getElementById("description").value,
        lairactions: [
          {
            description: document.getElementById("lairDescription").value,
            bullets: Array.from(document.querySelectorAll("#lairBullets input")).map(i => i.value)
          }
        ],
        regionaleffects: [
          {
            description: document.getElementById("regionalDescription").value,
            bullets: Array.from(document.querySelectorAll("#regionalBullets input")).map(i => i.value),
            secondaryDescription: document.getElementById("regionalSecondary").value
          }
        ],
        _file: name.toLowerCase().replace(/\s+/g, "_") + ".json",
        _displayName: name
      };

      const blob = new Blob([JSON.stringify(monster, null, 2)], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = monster._file;
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
