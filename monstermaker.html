<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Monster Maker</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .stat-row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }
    .stat-row label {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-weight: bold;
    }
    .stat-row input {
      width: 50px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Monster Maker</h1>
  <form id="monster-form">
    <label>Name: <input type="text" id="name"></label>
    <label>Description: <textarea id="description"></textarea></label>

    <label>Size:
      <select id="size">
        <option value="Tiny">Tiny</option>
        <option value="Small">Small</option>
        <option value="Medium" selected>Medium</option>
        <option value="Large">Large</option>
        <option value="Huge">Huge</option>
        <option value="Gargantuan">Gargantuan</option>
      </select>
    </label>

    <label>Type:
      <select id="type">
        <option value="aberration">Aberration</option>
        <option value="beast">Beast</option>
        <option value="celestial">Celestial</option>
        <option value="construct">Construct</option>
        <option value="dragon">Dragon</option>
        <option value="elemental">Elemental</option>
        <option value="fey">Fey</option>
        <option value="fiend">Fiend</option>
        <option value="giant">Giant</option>
        <option value="humanoid">Humanoid</option>
        <option value="monstrosity">Monstrosity</option>
        <option value="ooze">Ooze</option>
        <option value="plant">Plant</option>
        <option value="undead">Undead</option>
      </select>
    </label>

    <label>Alignment:
      <select id="alignment">
        <option>Lawful Good</option>
        <option>Neutral Good</option>
        <option>Chaotic Good</option>
        <option>Lawful Neutral</option>
        <option>True Neutral</option>
        <option>Chaotic Neutral</option>
        <option>Lawful Evil</option>
        <option>Neutral Evil</option>
        <option>Chaotic Evil</option>
      </select>
    </label>

    <label>Challenge Rating: <input type="text" id="cr"></label>
    <label>HP: <input type="text" id="hp"></label>
    <label>AC: <input type="text" id="ac"></label>
    <label>Speed: <input type="text" id="speed" placeholder="30 ft., fly 60 ft."></label>

    <h3>Ability Scores</h3>
    <div class="stat-row">
      <label>STR<input type="number" id="str" value="10"></label>
      <label>DEX<input type="number" id="dex" value="10"></label>
      <label>CON<input type="number" id="con" value="10"></label>
      <label>INT<input type="number" id="int" value="10"></label>
      <label>WIS<input type="number" id="wis" value="10"></label>
      <label>CHA<input type="number" id="cha" value="10"></label>
    </div>

    <label>Saving Throws: <input type="text" id="saves"></label>
    <label>Skills: <input type="text" id="skills"></label>
    <label>Damage Immunities: <input type="text" id="immunities"></label>
    <label>Damage Resistances: <input type="text" id="resistance"></label>
    <label>Damage Vulnerabilities: <input type="text" id="vulnerability"></label>
    <label>Condition Immunities: <input type="text" id="conimmunities"></label>
    <label>Senses: <input type="text" id="senses"></label>
    <label>Languages: <input type="text" id="languages"></label>
    <label>Legendary Actions per Round: <input type="number" id="legendarynumber" value="0"></label>
    <label>Source: <input type="text" id="source" placeholder="Homebrew, Monster Manual, etc."></label>

    <h3>Traits</h3>
    <div id="traits"></div>
    <button type="button" onclick="addField('traits')">+ Add Trait</button>

    <h3>Actions</h3>
    <div id="actions"></div>
    <button type="button" onclick="addField('actions')">+ Add Action</button>

    <h3>Reactions</h3>
    <div id="reactions"></div>
    <button type="button" onclick="addField('reactions')">+ Add Reaction</button>

    <h3>Legendary Actions</h3>
    <div id="legendary"></div>
    <button type="button" onclick="addField('legendary')">+ Add Legendary Action</button>

    <h3>Lair Actions</h3>
    <div id="lairactions"></div>
    <button type="button" onclick="addLair()">+ Add Lair Action Block</button>

    <h3>Regional Effects</h3>
    <div id="regionaleffects"></div>
    <button type="button" onclick="addRegional()">+ Add Regional Effects Block</button>

    <br><br>
    <button type="button" onclick="saveMonster()">Save Monster</button>
  </form>

  <script>
    function addField(section) {
      const container = document.getElementById(section);
      const div = document.createElement("div");
      div.innerHTML = `
        <label>Name: <input type="text" class="${section}-name"></label>
        <label>Description: <textarea class="${section}-desc"></textarea></label>
        <hr>`;
      container.appendChild(div);
    }

    function addLair() {
      const container = document.getElementById("lairactions");
      const div = document.createElement("div");
      div.innerHTML = `
        <label>Description: <textarea class="lair-desc"></textarea></label>
        <label>Bullets (one per line): <textarea class="lair-bullets"></textarea></label>
        <hr>`;
      container.appendChild(div);
    }

    function addRegional() {
      const container = document.getElementById("regionaleffects");
      const div = document.createElement("div");
      div.innerHTML = `
        <label>Description: <textarea class="regional-desc"></textarea></label>
        <label>Bullets (one per line): <textarea class="regional-bullets"></textarea></label>
        <label>Secondary Description: <textarea class="regional-secondary"></textarea></label>
        <hr>`;
      container.appendChild(div);
    }

    function saveMonster() {
      const monster = {
        name: document.getElementById("name").value,
        tags: [
          document.getElementById("size").value.toLowerCase(),
          document.getElementById("type").value,
          "cr" + document.getElementById("cr").value,
          document.getElementById("source").value
        ].filter(Boolean),
        size: document.getElementById("size").value,
        type: document.getElementById("type").value,
        alignment: document.getElementById("alignment").value.toLowerCase(),
        cr: document.getElementById("cr").value,
        hp: document.getElementById("hp").value,
        ac: document.getElementById("ac").value,
        speed: document.getElementById("speed").value,
        abilities: {
          str: parseInt(document.getElementById("str").value),
          dex: parseInt(document.getElementById("dex").value),
          con: parseInt(document.getElementById("con").value),
          int: parseInt(document.getElementById("int").value),
          wis: parseInt(document.getElementById("wis").value),
          cha: parseInt(document.getElementById("cha").value)
        },
        saves: document.getElementById("saves").value,
        skills: document.getElementById("skills").value,
        immunities: document.getElementById("immunities").value,
        resistance: document.getElementById("resistance").value,
        vulnerability: document.getElementById("vulnerability").value,
        conimmunities: document.getElementById("conimmunities").value,
        senses: document.getElementById("senses").value,
        languages: document.getElementById("languages").value,
        legendarynumber: document.getElementById("legendarynumber").value,
        traits: collectFields("traits"),
        actions: collectFields("actions"),
        reactions: collectFields("reactions"),
        legendary: collectFields("legendary"),
        lairactions: collectLairs(),
        regionaleffects: collectRegionals(),
        description: document.getElementById("description").value,
        _file: "custom_monster.json",
        _displayName: document.getElementById("name").value
      };

      const blob = new Blob([JSON.stringify(monster, null, 2)], { type: "application/json" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = monster.name.replace(/\s+/g, "_").toLowerCase() + ".json";
      a.click();
    }

    function collectFields(section) {
      return [...document.querySelectorAll("#" + section + " > div")].map(div => ({
        name: div.querySelector("." + section + "-name").value,
        desc: div.querySelector("." + section + "-desc").value
      }));
    }

    function collectLairs() {
      return [...document.querySelectorAll("#lairactions > div")].map(div => ({
        description: div.querySelector(".lair-desc").value,
        bullets: div.querySelector(".lair-bullets").value.split("\n").filter(Boolean)
      }));
    }

    function collectRegionals() {
      return [...document.querySelectorAll("#regionaleffects > div")].map(div => ({
        description: div.querySelector(".regional-desc").value,
        bullets: div.querySelector(".regional-bullets").value.split("\n").filter(Boolean),
        secondaryDescription: div.querySelector(".regional-secondary").value
      }));
    }
  </script>
</body>
</html>
